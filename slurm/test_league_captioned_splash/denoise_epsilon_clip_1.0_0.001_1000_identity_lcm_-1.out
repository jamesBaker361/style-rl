gcc (GCC) 10.3.0
Copyright (C) 2020 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

SLURMD_NODENAME gpu014
SBATCH_CLUSTERS doesnt exist
SBATCH_PARTITION doesnt exist
SLURM_JOB_PARTITION gpu
SLURM_NODEID 0
SLURM_MEM_PER_GPU doesnt exist
SLURM_MEM_PER_CPU doesnt exist
SLURM_MEM_PER_NODE 128000
SLURM_JOB_ID 47372301
torch.cuda.get_device_name() NVIDIA GeForce RTX 2080 Ti
torch.cuda.get_device_capability() (7, 5)
GPU Name: NVIDIA GeForce RTX 2080 Ti
GPU Memory Total: 11011.5 MB
GPU Memory Free: 2509.58056640625 MB
GPU Memory Used: 5130.0 MB
Namespace(dataset='jlbaker361/clip-league_captioned_splash-1000', mixed_precision='fp16', project_name='league_captioned_splash-1000-beta', gradient_accumulation_steps=8, image_size=256, embedding='clip', facet='query', pipeline='lcm', batch_size=2, epochs=1000, training_type='denoise', prediction_type='epsilon', train_split=0.95, validation_interval=40, uncaptioned_frac=1.0, intermediate_embedding_dim=1024, cross_attention_dim=768, limit=-1, num_inference_steps=20, dino_pooling_stride=4, num_image_text_embeds=4, deepspeed=False, fsdp=False, vanilla=True, name='jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1', load=False, load_hf=True, upload_interval=1, generic_test_prompts=True, lr=0.001, disable_projection_adapter=False, identity_adapter=True, deep_to_ip_layers=False, scheduler_type='LCMScheduler', reward_switch_epoch=-1, initial_scale=1.0, final_scale=1.0, sigma_data=-0.8)
accelerator device cuda
Rank 0 initialized successfully
main process = 0

MODEL-NAME  denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1
LCMScheduler {
  "_class_name": "LCMScheduler",
  "_diffusers_version": "0.33.1",
  "beta_end": 0.012,
  "beta_schedule": "scaled_linear",
  "beta_start": 0.00085,
  "clip_sample": false,
  "clip_sample_range": 1.0,
  "dynamic_thresholding_ratio": 0.995,
  "num_train_timesteps": 1000,
  "original_inference_steps": 50,
  "prediction_type": "epsilon",
  "rescale_betas_zero_snr": false,
  "sample_max_value": 1.0,
  "set_alpha_to_one": true,
  "steps_offset": 1,
  "thresholding": false,
  "timestep_scaling": 10.0,
  "timestep_spacing": "leading",
  "trained_betas": null
}

scheduler add_noise exists
scheduler get_velocity exists
scheduler step exists
LCMScheduler {
  "_class_name": "LCMScheduler",
  "_diffusers_version": "0.33.1",
  "beta_end": 0.012,
  "beta_schedule": "scaled_linear",
  "beta_start": 0.00085,
  "clip_sample": false,
  "clip_sample_range": 1.0,
  "dynamic_thresholding_ratio": 0.995,
  "num_train_timesteps": 1000,
  "original_inference_steps": 50,
  "prediction_type": "epsilon",
  "rescale_betas_zero_snr": false,
  "sample_max_value": 1.0,
  "set_alpha_to_one": true,
  "steps_offset": 1,
  "thresholding": false,
  "timestep_scaling": 10.0,
  "timestep_spacing": "leading",
  "trained_betas": null
}

images are already denormalized max: 1.0 min: 8.64267349243164e-06, NOT denormalizing
use_projection and args.identity_adapter are both true
loaded from   /scratch/jlb638/trans_cache/models--jlbaker361--denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/snapshots/6ae8726fd9a9281c4138e01ecca3fa25c6ea51ad/unet_model.bin
start epoch 700
successful generating:) time elapsed: 72.16409683227539 seconds = 0.02004558245340983 hours
all done!

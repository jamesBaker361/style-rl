gcc (GCC) 10.3.0
Copyright (C) 2020 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Running on: gpu017.amarel.rutgers.edu
Allocated GPUs:
Mon Oct  6 18:29:51 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.154.05             Driver Version: 535.154.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce RTX 3090        On  | 00000000:18:00.0 Off |                  N/A |
| 35%   45C    P8              30W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA GeForce RTX 3090        On  | 00000000:3B:00.0 Off |                  N/A |
| 31%   33C    P8              27W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA GeForce RTX 3090        On  | 00000000:86:00.0 Off |                  N/A |
| 33%   32C    P8              37W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA GeForce RTX 3090        On  | 00000000:AF:00.0 Off |                  N/A |
| 30%   29C    P8              18W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
version
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2023 NVIDIA Corporation
Built on Tue_Feb__7_19:32:13_PST_2023
Cuda compilation tools, release 12.1, V12.1.66
Build cuda_12.1.r12.1/compiler.32415258_0
SLURMD_NODENAME gpu017
SBATCH_CLUSTERS doesnt exist
SBATCH_PARTITION doesnt exist
SLURM_JOB_PARTITION gpu
SLURM_NODEID 0
SLURM_MEM_PER_GPU doesnt exist
SLURM_MEM_PER_CPU doesnt exist
SLURM_MEM_PER_NODE 128000
SLURM_JOB_ID 47371028
torch.cuda.get_device_name() NVIDIA GeForce RTX 3090
torch.cuda.get_device_capability() (8, 6)
GPU Name: NVIDIA GeForce RTX 3090
GPU Memory Total: 24259.6875 MB
GPU Memory Free: 2509.58056640625 MB
GPU Memory Used: 5130.0 MB
Namespace(dataset='jlbaker361/ssl-league_captioned_splash-1000', mixed_precision='fp16', project_name='league_captioned_splash-1000-beta', gradient_accumulation_steps=8, image_size=256, embedding='ssl', facet='query', pipeline='lcm', batch_size=2, epochs=1000, training_type='denoise', prediction_type='epsilon', train_split=0.95, validation_interval=40, uncaptioned_frac=1.0, intermediate_embedding_dim=1024, cross_attention_dim=768, limit=-1, num_inference_steps=20, dino_pooling_stride=4, num_image_text_embeds=4, deepspeed=False, fsdp=False, vanilla=True, name='jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1', load=True, load_hf=False, upload_interval=1, generic_test_prompts=True, lr=0.001, disable_projection_adapter=False, identity_adapter=True, deep_to_ip_layers=False, scheduler_type='LCMScheduler', reward_switch_epoch=-1, initial_scale=1.0, final_scale=1.0, sigma_data=-0.8)
accelerator device cuda
Rank 0 initialized successfully
main process = 0

MODEL-NAME  denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1
LCMScheduler {
  "_class_name": "LCMScheduler",
  "_diffusers_version": "0.33.1",
  "beta_end": 0.012,
  "beta_schedule": "scaled_linear",
  "beta_start": 0.00085,
  "clip_sample": false,
  "clip_sample_range": 1.0,
  "dynamic_thresholding_ratio": 0.995,
  "num_train_timesteps": 1000,
  "original_inference_steps": 50,
  "prediction_type": "epsilon",
  "rescale_betas_zero_snr": false,
  "sample_max_value": 1.0,
  "set_alpha_to_one": true,
  "steps_offset": 1,
  "thresholding": false,
  "timestep_scaling": 10.0,
  "timestep_spacing": "leading",
  "trained_betas": null
}

scheduler add_noise exists
scheduler get_velocity exists
scheduler step exists
LCMScheduler {
  "_class_name": "LCMScheduler",
  "_diffusers_version": "0.33.1",
  "beta_end": 0.012,
  "beta_schedule": "scaled_linear",
  "beta_start": 0.00085,
  "clip_sample": false,
  "clip_sample_range": 1.0,
  "dynamic_thresholding_ratio": 0.995,
  "num_train_timesteps": 1000,
  "original_inference_steps": 50,
  "prediction_type": "epsilon",
  "rescale_betas_zero_snr": false,
  "sample_max_value": 1.0,
  "set_alpha_to_one": true,
  "steps_offset": 1,
  "thresholding": false,
  "timestep_scaling": 10.0,
  "timestep_spacing": "leading",
  "trained_betas": null
}

text size torch.Size([77, 768]) embedding size torch.Size([1, 1536]) img size torch.Size([3, 256, 256]) latent size torch.Size([8, 32, 32])
prompt list 1000
image_list 1000
text_list 1000
posterior list 1000
embedding list 1000
images are already denormalized max: 1.0 min: 7.569789886474609e-06, NOT denormalizing
use_projection and args.identity_adapter are both true
loaded from  /scratch/jlb638/local_torch/jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
len attn_layers 17
before  96
after 32
train/test/val (0.95, 0.025000000000000022, 0.025000000000000022)
prompt list 950
image_list 950
text_list 950
posterior list 950
embedding list 950
dataset batch <class 'dict'>
train batch <class 'dict'>
val batch <class 'dict'>
trainable params:  128
Rank 0 checkpoint
registered
<class 'accelerate.data_loader.DataLoaderShard'>
<class 'accelerate.data_loader.DataLoaderShard'>
<class 'accelerate.data_loader.DataLoaderShard'>
training from 557 to 1000
scale 1.0
text size torch.Size([2, 77, 768]) embedding size torch.Size([2, 1, 1536]) img size torch.Size([2, 3, 256, 256]) latent size torch.Size([2, 8, 32, 32])
text device cuda:0 embedding device cuda:0 img device cuda:0 latent device cuda:0
text  torch.float16 embedding  torch.float16 img  torch.float16 latent  torch.float16
	 epoch 557 elapsed 862.718462228775
state dict len 128
saved /scratch/jlb638/local_torch/jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 558 elapsed 836.5463552474976
state dict len 128
saved /scratch/jlb638/local_torch/jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 559 elapsed 857.7908360958099
state dict len 128
saved /scratch/jlb638/local_torch/jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 560 elapsed 809.9577555656433
validation interval  560

OOM  denoise_epsilon_ssl_1.0_0.001_1000_identity_lcm_-1
[1;34mwandb[0m: 
[1;34mwandb[0m: ðŸš€ View run [33mnorthern-smoke-1503[0m at: [34mhttps://wandb.ai/jlbaker361/league_captioned_splash-1000-beta/runs/gdlcgtys[0m
[1;34mwandb[0m: Find logs at: [1;35m../../../../scratch/jlb638/wandb/wandb/run-20251006_183205-gdlcgtys/logs[0m
Running on: gpu017.amarel.rutgers.edu
Allocated GPUs:
Mon Oct  6 20:06:33 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.154.05             Driver Version: 535.154.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce RTX 3090        On  | 00000000:18:00.0 Off |                  N/A |
| 39%   49C    P8              34W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA GeForce RTX 3090        On  | 00000000:3B:00.0 Off |                  N/A |
| 31%   33C    P8              28W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA GeForce RTX 3090        On  | 00000000:86:00.0 Off |                  N/A |
| 33%   31C    P8              36W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA GeForce RTX 3090        On  | 00000000:AF:00.0 Off |                  N/A |
| 30%   28C    P8              19W / 350W |      1MiB / 24576MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+

gcc (GCC) 13.3.0
Copyright (C) 2023 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Running on: g20-09
Allocated GPUs:
Fri Sep 19 07:35:38 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.51.03              Driver Version: 575.51.03      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Quadro RTX 6000                On  |   00000000:1B:00.0 Off |                  Off |
| 33%   24C    P8              4W /  260W |       1MiB /  24576MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
version
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2025 NVIDIA Corporation
Built on Wed_Jan_15_19:20:09_PST_2025
Cuda compilation tools, release 12.8, V12.8.61
Build cuda_12.8.r12.8/compiler.35404655_0
SLURMD_NODENAME g20-09
SBATCH_CLUSTERS doesnt exist
SBATCH_PARTITION doesnt exist
SLURM_JOB_PARTITION gpu
SLURM_NODEID 0
SLURM_MEM_PER_GPU doesnt exist
SLURM_MEM_PER_CPU doesnt exist
SLURM_MEM_PER_NODE 128000
SLURM_JOB_ID 98862
torch.cuda.get_device_name() Quadro RTX 6000
torch.cuda.get_device_capability() (7, 5)
GPU Name: Quadro RTX 6000
GPU Memory Total: 24023.75 MB
GPU Memory Free: 2509.58056640625 MB
GPU Memory Used: 5130.0 MB
Namespace(dataset='jlbaker361/clip-league_captioned_splash-1000', mixed_precision='fp16', project_name='league_captioned_splash-1000-beta', gradient_accumulation_steps=8, image_size=256, embedding='clip', facet='query', pipeline='lcm', batch_size=2, epochs=1000, training_type='denoise', prediction_type='epsilon', train_split=0.95, validation_interval=40, uncaptioned_frac=1.0, intermediate_embedding_dim=1024, cross_attention_dim=768, limit=-1, num_inference_steps=20, dino_pooling_stride=4, num_image_text_embeds=4, deepspeed=False, fsdp=False, vanilla=True, name='jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1', load=False, load_hf=True, upload_interval=1, generic_test_prompts=True, lr=0.001, disable_projection_adapter=False, identity_adapter=True, deep_to_ip_layers=False, scheduler_type='LCMScheduler', reward_switch_epoch=-1, initial_scale=1.0, final_scale=1.0, sigma_data=-0.8)
accelerator device cuda
Rank 0 initialized successfully
main process = 0

MODEL-NAME  denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1
LCMScheduler {
  "_class_name": "LCMScheduler",
  "_diffusers_version": "0.35.1",
  "beta_end": 0.012,
  "beta_schedule": "scaled_linear",
  "beta_start": 0.00085,
  "clip_sample": false,
  "clip_sample_range": 1.0,
  "dynamic_thresholding_ratio": 0.995,
  "num_train_timesteps": 1000,
  "original_inference_steps": 50,
  "prediction_type": "epsilon",
  "rescale_betas_zero_snr": false,
  "sample_max_value": 1.0,
  "set_alpha_to_one": true,
  "steps_offset": 1,
  "thresholding": false,
  "timestep_scaling": 10.0,
  "timestep_spacing": "leading",
  "trained_betas": null
}

scheduler add_noise exists
scheduler get_velocity exists
scheduler step exists
LCMScheduler {
  "_class_name": "LCMScheduler",
  "_diffusers_version": "0.35.1",
  "beta_end": 0.012,
  "beta_schedule": "scaled_linear",
  "beta_start": 0.00085,
  "clip_sample": false,
  "clip_sample_range": 1.0,
  "dynamic_thresholding_ratio": 0.995,
  "num_train_timesteps": 1000,
  "original_inference_steps": 50,
  "prediction_type": "epsilon",
  "rescale_betas_zero_snr": false,
  "sample_max_value": 1.0,
  "set_alpha_to_one": true,
  "steps_offset": 1,
  "thresholding": false,
  "timestep_scaling": 10.0,
  "timestep_spacing": "leading",
  "trained_betas": null
}

text size torch.Size([77, 768]) embedding size torch.Size([1, 768]) img size torch.Size([3, 256, 256]) latent size torch.Size([8, 32, 32])
prompt list 1000
image_list 1000
text_list 1000
posterior list 1000
embedding list 1000
images are already denormalized max: 1.0 min: 8.64267349243164e-06, NOT denormalizing
use_projection and args.identity_adapter are both true
loaded from   /umbc/ada/donengel/common/trans_cache/models--jlbaker361--denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/snapshots/3750e8b2b1b97aad8987c1a3adde162980c5d52a/unet_model.bin
len attn_layers 17
before  96
after 32
train/test/val (0.95, 0.025000000000000022, 0.025000000000000022)
prompt list 950
image_list 950
text_list 950
posterior list 950
embedding list 950
dataset batch <class 'dict'>
train batch <class 'dict'>
val batch <class 'dict'>
trainable params:  128
Rank 0 checkpoint
registered
<class 'accelerate.data_loader.DataLoaderShard'>
<class 'accelerate.data_loader.DataLoaderShard'>
<class 'accelerate.data_loader.DataLoaderShard'>
training from 868 to 1000
scale 1.0
text size torch.Size([2, 77, 768]) embedding size torch.Size([2, 1, 768]) img size torch.Size([2, 3, 256, 256]) latent size torch.Size([2, 8, 32, 32])
text device cuda:0 embedding device cuda:0 img device cuda:0 latent device cuda:0
text  torch.float16 embedding  torch.float16 img  torch.float16 latent  torch.float16
	 epoch 868 elapsed 799.646787405014
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 869 elapsed 799.4027349948883
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 870 elapsed 808.930415391922
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 871 elapsed 796.8513512611389
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 872 elapsed 769.1235246658325
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 873 elapsed 773.2237646579742
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 874 elapsed 806.3739972114563
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0
	 epoch 875 elapsed 829.1243221759796
state dict len 128
saved /umbc/ada/donengel/common/local_torch/jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1/unet_model.bin
uploaded jlbaker361/denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1 to hub
scale 1.0

OOM  denoise_epsilon_clip_1.0_0.001_1000_identity_lcm_-1
[1;34mwandb[0m: 
[1;34mwandb[0m: ðŸš€ View run [33mskilled-dew-982[0m at: [34mhttps://wandb.ai/jlbaker361/league_captioned_splash-1000-beta/runs/7e8e1mhm[0m
[1;34mwandb[0m: Find logs at: [1;35m../../../../../ada/donengel/common/wandb/wandb/run-20250919_074036-7e8e1mhm/logs[0m
Running on: g20-09
Allocated GPUs:
Fri Sep 19 10:07:56 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.51.03              Driver Version: 575.51.03      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Quadro RTX 6000                On  |   00000000:1B:00.0 Off |                  Off |
| 33%   44C    P0             89W /  260W |       1MiB /  24576MiB |    100%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
